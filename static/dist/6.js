webpackJsonp([6],{527:function(t,e,r){"use strict";function a(t){r(602)}Object.defineProperty(e,"__esModule",{value:!0});var n=r(584),o=r.n(n);for(var i in n)"default"!==i&&function(t){r.d(e,t,function(){return n[t]})}(i);var s=r(608),l=r(135),u=a,c=l(o.a,s.a,!1,u,"data-v-37e83c65",null);e.default=c.exports},578:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(579),n=r(135),o=n(null,a.a,!1,null,null,null);e.default=o.exports},579:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-menu",{staticClass:"el-menu-demo",attrs:{theme:"dark","default-active":t.$route.path,mode:"horizontal",router:!0}},[r("el-menu-item",{attrs:{index:"/"}},[t._v("什么值得买")]),t._v(" "),r("el-menu-item",{attrs:{index:"/admin/categories"}},[t._v("分类管理")]),t._v(" "),r("el-menu-item",{attrs:{index:"/admin/tags"}},[t._v("标签管理")]),t._v(" "),r("el-menu-item",{attrs:{index:"/admin/products"}},[t._v("商品管理")]),t._v(" "),r("el-menu-item",{attrs:{index:"/admin/users"}},[t._v("用户管理")])],1),t._v(" "),t._t("body")],2)},n=[],o={render:a,staticRenderFns:n};e.a=o},584:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function a(n,o){try{var i=e[n](o),s=i.value}catch(t){return void r(t)}if(!i.done)return Promise.resolve(s).then(function(t){a("next",t)},function(t){a("throw",t)});t(s)}return a("next")})}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(578),i=a(o),s=r(604),l=a(s),u=r(136);e.default={components:{"layout-component":i.default,"form-component":l.default},data:function(){return{cates:[],products:[],page:{limit:10,total:0,page:1,pages:1},showAddDialog:!1,addForm:{name:"",category:"",price:0,tags:[]},showEditDialog:!1,editForm:{name:"",category:"",price:0,tags:[]},showRemoveDialog:!1,removeForm:{},showDetailsDialog:!1,detailsForm:{}}},head:{title:{inner:"商品管理"}},methods:{getCates:function(){var t=this;return n(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetch.get(u.category.findAll);case 2:r=e.sent,t.cates=r.data.cates;case 4:case"end":return e.stop()}},e,t)}))()},getProducts:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return n(regeneratorRuntime.mark(function r(){var a,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.fetch.get(u.product.findByPage(e));case 2:a=r.sent,n=a.data.products,t.products=n.docs,t.page={limit:n.limit,total:n.total,page:n.page,pages:n.pages};case 6:case"end":return r.stop()}},r,t)}))()},addTag:function(t){var e=this;return n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetch.post(u.tag.add,{name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r,e)}))()},add:function(t){var e=this;return n(regeneratorRuntime.mark(function r(){var a,n,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.fetch.post(u.product.add,t);case 2:return a=r.sent,n=a.data.ok?"success":"error",o=t.tags.map(function(t){return e.addTag(t)}),r.next=7,Promise.all(o);case 7:return r.next=9,e.getProducts();case 9:e.showAddDialog=!1,e.addForm={},e.$message({message:a.data.msg,type:n});case 12:case"end":return r.stop()}},r,e)}))()},edit:function(t){var e=this;return n(regeneratorRuntime.mark(function r(){var a,n,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.fetch.post(u.product.edit,t);case 2:return a=r.sent,n=a.data.ok?"success":"error",o=t.tags.map(function(t){return e.addTag(t)}),r.next=7,Promise.all(o);case 7:return r.next=9,e.getProducts();case 9:e.showEditDialog=!1,e.showDetailsDialog=!1,e.$message({message:a.data.msg,type:n});case 12:case"end":return r.stop()}},r,e)}))()},remove:function(){var t=this;return n(regeneratorRuntime.mark(function e(){var r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetch.post(u.product.remove,t.removeForm);case 2:return r=e.sent,a=r.data.ok?"success":"error",e.next=6,t.getProducts();case 6:t.showRemoveDialog=!1,t.$message({message:r.data.msg,type:a});case 8:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.getCates(),this.getProducts()}}},585:function(t,e,r){"use strict";function a(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function a(n,o){try{var i=e[n](o),s=i.value}catch(t){return void r(t)}if(!i.done)return Promise.resolve(s).then(function(t){a("next",t)},function(t){a("throw",t)});t(s)}return a("next")})}}function n(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});r(136);e.default={props:{title:String,showDialog:Boolean,cates:Array,model:{name:String,category:String,price:Number,img:String,link:String,tags:Array}},data:function(){return{formLabelWidth:"120px",newTag:"",tags:[],rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],category:[{type:"object",required:!0,message:"请选择商品分类",trigger:"blur"}],price:[{type:"number",required:!0,message:"请输入商品价格",trigger:"blur"}]}}},computed:{categories:function(){return this.cates},form:function(){return this.model&&this.model.tags&&(this.tags=[].concat(n(this.model.tags))),this.model}},methods:{hide:function(){this.$emit("hide")},validate:function(){var t=this;return new Promise(function(e,r){t.$refs.form.validate(function(t){t?e(!0):r(!1)})})},confirm:function(){var t=this;return a(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.validate();case 2:r=e.sent,r&&(t.form.tags=t.tags,t.$emit("confirm",t.form),t.tags=[]);case 4:case"end":return e.stop()}},e,t)}))()},addTag:function(){this.newTag.length&&(this.tags.push(this.newTag),this.newTag="")},removeTag:function(t){this.tags.splice(t,1)}}}},602:function(t,e,r){var a=r(603);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(524)("18033677",a,!0,{})},603:function(t,e,r){e=t.exports=r(202)(!1),e.push([t.i,".add-btn[data-v-37e83c65]{margin:10px}.tag[data-v-37e83c65]{margin-right:10px}",""])},604:function(t,e,r){"use strict";function a(t){r(605)}Object.defineProperty(e,"__esModule",{value:!0});var n=r(585),o=r.n(n);for(var i in n)"default"!==i&&function(t){r.d(e,t,function(){return n[t]})}(i);var s=r(607),l=r(135),u=a,c=l(o.a,s.a,!1,u,"data-v-22712534",null);e.default=c.exports},605:function(t,e,r){var a=r(606);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(524)("ee86d376",a,!0,{})},606:function(t,e,r){e=t.exports=r(202)(!1),e.push([t.i,".tag[data-v-22712534]{margin-right:10px}",""])},607:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:t.title,visible:t.showDialog,"before-close":t.hide},on:{"update:visible":function(e){t.showDialog=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[r("el-form-item",{attrs:{label:"商品名称","label-width":t.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品分类","label-width":t.formLabelWidth,prop:"category"}},[r("el-select",{attrs:{"value-key":"_id"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.categories,function(t){return r("el-option",{key:t._id,attrs:{label:t.name,value:t}})}))],1),t._v(" "),r("el-form-item",{attrs:{label:"商品价格","label-width":t.formLabelWidth,prop:"price"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",t._n(e))},expression:"form.price"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品图片","label-width":t.formLabelWidth}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.img,callback:function(e){t.$set(t.form,"img",t._n(e))},expression:"form.img"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"商品链接","label-width":t.formLabelWidth}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",t._n(e))},expression:"form.link"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"标签","label-width":t.formLabelWidth}},[r("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addTag(e):null}},model:{value:t.newTag,callback:function(e){t.newTag=e},expression:"newTag"}}),t._v(" "),t._l(t.tags,function(e,a){return r("el-tag",{key:e,staticClass:"tag",attrs:{closable:!0,type:"primary"},on:{close:function(e){t.removeTag(a)}}},[t._v(t._s(e))])})],2)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.hide}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},n=[],o={render:a,staticRenderFns:n};e.a=o},608:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("layout-component",[r("div",{attrs:{slot:"body"},slot:"body"},[r("el-button",{staticClass:"add-btn",attrs:{type:"primary",icon:"plus"},on:{click:function(e){t.showAddDialog=!0}}},[t._v("添加商品")]),t._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.products}},[r("el-table-column",{attrs:{label:"图片",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.img}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"name",label:"名称",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{prop:"category.name",label:"分类",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{prop:"price",label:"价格(￥)",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{label:"链接",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"primary",size:"small"}},[r("a",{staticStyle:{color:"#fff"},attrs:{href:e.row.link,target:"_blank"}},[t._v("链接")])])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"标签",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.tags,function(e){return r("el-tag",{key:e,staticClass:"tag",attrs:{type:"primary"}},[t._v(t._s(e))])})}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"prettyCreatedAt",label:"添加时间",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){t.showEditDialog=!0,t.editForm=e.row}}},[t._v("\n                        编辑\n                    ")]),t._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){t.showDetailsDialog=!0,t.detailsForm=e.row}}},[t._v("\n                        编辑详情\n                    ")]),t._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){t.showRemoveDialog=!0,t.removeForm=e.row}}},[t._v("\n                        删除\n                    ")])]}}])})],1),t._v(" "),r("el-pagination",{attrs:{layout:"prev, pager, next","page-size":t.page.limit,total:t.page.total,"current-page":t.page.page},on:{"current-change":t.getProducts}}),t._v(" "),r("form-component",{attrs:{title:"添加商品",cates:t.cates,showDialog:t.showAddDialog,model:t.addForm},on:{confirm:t.add,hide:function(e){t.showAddDialog=!1}}}),t._v(" "),r("form-component",{attrs:{title:"编辑商品",cates:t.cates,showDialog:t.showEditDialog,model:t.editForm},on:{confirm:t.edit,hide:function(e){t.showEditDialog=!1}}}),t._v(" "),r("el-dialog",{attrs:{title:"编辑商品详情",visible:t.showDetailsDialog},on:{"update:visible":function(e){t.showDetailsDialog=e}}},[r("el-input",{attrs:{type:"textarea",rows:20,placeholder:"请输入商品详情，支持 markdown 语法格式"},model:{value:t.detailsForm.details,callback:function(e){t.$set(t.detailsForm,"details",e)},expression:"detailsForm.details"}}),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.showDetailsDialog=!1}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.edit(t.detailsForm)}}},[t._v("确 定")])],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"删除商品",visible:t.showRemoveDialog},on:{"update:visible":function(e){t.showRemoveDialog=e}}},[r("el-alert",{attrs:{title:"确定删除商品："+t.removeForm.name+"？",type:"error",closable:!1}}),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.showRemoveDialog=!1}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.remove}},[t._v("确 定")])],1)],1)],1)])},n=[],o={render:a,staticRenderFns:n};e.a=o}});
//# sourceMappingURL=6.js.map